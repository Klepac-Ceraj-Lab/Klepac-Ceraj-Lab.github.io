<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/jtd.css"> <link rel=icon  href="/assets/favicon.ico"> <title>Setting up SSH</title> <div class=page-wrap > <div class=side-bar > <div class=header > <a href="/" class=title > VKC Lab Protocols </a> </div> <label for=show-menu  class=show-menu >MENU</label> <input type=checkbox  id=show-menu  role=button > <div class=menu  id=side-menu > <ul class=menu-list > <li class="menu-list-item "><a href="/" class="menu-list-link ">Home</a> <li class="menu-list-item "><a href="/wetlab/" class="menu-list-link ">Wet Lab Protocols</a> <li class="menu-list-item active"><a href="/drylab/" class="menu-list-link ">Dry Lab Protocols</a> <li class="menu-list-item "><a href="/handbook/" class="menu-list-link ">Lab Handbook</a> <ul class="menu-list-child-list "> <li class="menu-list-item "><a href="#ii_research_opportunities_and_expectations" class=menu-list-link >Research Expectations</a> <li class="menu-list-item "><a href="#iib_additional_expectations_for_thesis_students" class=menu-list-link >Thesis Expectations</a> <li class="menu-list-item "><a href="#iii_meetings_and_presentations" class=menu-list-link >Presentations</a> <li class="menu-list-item "><a href="#vi_agreements_and_contracts" class=menu-list-link >Agreements and Contracts</a> </ul> </ul> </div> <div class=footer > This is <em>Just the docs</em>, adapted from the <a href="https://github.com/pmarsceill/just-the-docs" target=_blank >Jekyll theme</a>. </div> </div> <div class=main-content-wrap > <div class=main-content > <div class=main-header > <a id=github  href="//github.com/Klepac-Ceraj-Lab">The VKC Lab on GitHub</a> </div> <div class=franklin-content ><h1 id=setting_up_ssh_access ><a href="#setting_up_ssh_access" class=header-anchor >Setting up SSH access</a></h1> <p>SSH &#40;<strong>S</strong>ecure <strong>SH</strong>ell&#41; is a protocol for sending information securely over the internet. For our purposes, it enables us to send files and even commands for interacting with software on remote computers. This way, you can have a terminal open on your laptop that has all the power of the lab servers.</p> <p>This page will help you set up <em>authentication</em> with a lab server. We don&#39;t want just anyone to log in, so we are using a method of authentication using &quot;key pair encryption.&quot; Don&#39;t worry - you don&#39;t need to know what that means in order to use it effectively.</p> <ul> <li><p>If you are a user that needs to set up SSH access for the first time, go to the <a href="#users">next section</a></p> <li><p>If you are an administrator that needs to set up an account for a new user, <a href="/drylab/newusers">go here</a></p> <li><p>If you are having problems with either of these things, <a href="#troubleshooting">go here</a></p> </ul> <h2 id=users ><a href="#users" class=header-anchor >Users</a></h2> <p>If you need to access <a href="/drylab/computers">lab servers</a> remotely, you&#39;ll need to:</p> <ol> <li><p>Have a user account set up on the server that you need access to.</p> <li><p>Create an ssh key pair on your local computer &#40;eg your laptop&#41;</p> <li><p>Have an administrator &#40;eg Kevin&#41; add your public key as an authorized key for your user</p> <li><p>Set up your computer to use that key when attempting to connect to the lab server</p> </ol> <p>Let&#39;s get started&#33;</p> <h3 id=user_account_set_up ><a href="#user_account_set_up" class=header-anchor ><ol> <li><p>User account set up</p> </ol> </a></h3> <p>For this, you&#39;ll need a server administrator &#40;eg Kevin or Shelley&#41; to set up a user account for you on the remote server.</p> <p><a href="https://github.com/Klepac-Ceraj-Lab/klepac-ceraj-lab.github.io/issues/new?assignees&#61;kescobo&amp;labels&#61;admin&amp;template&#61;new-user.md&amp;title&#61;&#37;5BNEW&#43;USER&#37;5D&#43;your-name-here">Open an issue</a> with the &quot;new user&quot; template.</p> <p>Add your name to the issue title, eg <code>&#91;NEW USER&#93; Jane Doe</code></p> <p>Fill out the information requested:</p> <ul> <li><p><strong>Name</strong>: Your name, eg &quot;Jane Doe&quot;</p> <li><p><strong>Wellesley email</strong>: the user associated with your @wellesley.edu email, eg &quot;jdoe123&quot;</p> <li><p><strong>Requested username</strong>: Typically your first name, or first initial and last name, all lowercase. Eg &quot;jane&quot;</p> <li><p><strong>Server&#40;s&#41; you need access to</strong>: Put an <code>x</code> between the brackets &#40;and remove the space&#41; for the server&#40;s&#41; you need access to. For example, if you need access to <code>ada</code> and <code>rosalind</code>, it should look like this:</p> </ul> <pre><code class="julia hljs">- [x] <span class=hljs-string >`ada`</span>
- [ ] <span class=hljs-string >`hopper`</span>
- [x] <span class=hljs-string >`rosalind`</span></code></pre> <ul> <li><p><strong>Public Key</strong> &#40;see below&#41;</p> </ul> <h3 id=ol_start2_create_ssh_key_pair ><a href="#ol_start2_create_ssh_key_pair" class=header-anchor ><ol start=2 > <li><p>Create SSH key pair</p> </ol> </a></h3> <p>On your local laptop, create a directory in your home folder &#40;if it doesn&#39;t already exist&#41; called <code>.ssh/</code>, and then change it to be your working directory.</p> <pre><code class="sh hljs">$ <span class=hljs-built_in >mkdir</span> ~/.ssh/
$ <span class=hljs-built_in >cd</span> ~/.ssh</code></pre> <p>Now, run the <code>ssh-keygen</code> command to make a new key pair for each server you need access to. If you just run <code>ssh-keygen</code> with no arguments, it will prompt you for a file location and a password. Or you can enter them as arguments, the <code>-f</code> argument to specify location, and <code>-N</code> to specify password.</p> <pre><code class="sh hljs">$ ssh-keygen -f ada-key -N <span class=hljs-string >&quot;Z4utPR9ij#4Go&amp;&quot;</span>
Generating public/private rsa key pair.
Your identification has been saved <span class=hljs-keyword >in</span> foo-key
Your public key has been saved <span class=hljs-keyword >in</span> foo-key.pub
The key fingerprint is:
SHA256:iPHKUK1CnlyabTv9ceVE8H71NStHcNU5BRgIBntDsF4 kevin@gazelle
The key<span class=hljs-string >&#x27;s randomart image is:
+---[RSA 3072]----+
|      oo+....+.oB|
|     . =  .o. oo.|
|  . + + E   o  o+|
| + B * + . o  ..=|
|  O = + S   +..o.|
|   = +     + .o  |
|    = . . . .    |
|     . . o       |
|        .        |
+----[SHA256]-----+</span></code></pre> <p>If you look in your directory, you should now see 2 files, one with the file name you specified &#40;I recommend <code>&lt;servername&gt;-key</code>, eg <code>ada-key</code> or <code>hopper-key</code>&#41; and one with the same name and the <code>.pub</code> extension. The first is your <em>private</em> key, and the other is your <em>public</em> key.</p> <p><strong>Do not share your private key</strong></p> <p>Add the contents of your public key in the github issue you started above. You can see the contents of the public key using <code>cat</code>: eg:</p> <pre><code class="sh hljs">$ <span class=hljs-built_in >cat</span> ada-key.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDCCS+GHc79dd561BwJ4UHyQqDhNKTy4gvgjQB2WF4v0X4kePuTLbB5yDdbmb2Xo20bqqgjVY8k6Sgx/VT89XiBS3acoPqPYEgakRYysx4T2ARg+rVdnSH7J9YFywbYPvU9k/KTrBCwt1s1q1KM3YfmHpOuFyvydfZoT09J4wd6JXcXe9bfHJmbPK6dpoPCZhC7VgbIzP6ulQTj6d5UUpjwpodwRUXAOPMfb3AzmVXzvcJBtoROMtoCV5977Sh3l6X7gbvg61A8TJrptMV1XJzYmLKk7RMy9Md/KfkB7uNCihq6NVYqR8r47fgws70QxyStCod33JC5RXMq8fSi9fmMxPZqn804vgmKqb+lIWoaiRhYK/qcfkjTFzH/XWHnAGLhy63G6T1eDDp2Vn6zuhhPoViCQaQ0Ep84+pYkixjbDqs6WpMSucY8xrSBTSrZ9E/mKd2hwovjYQPxQg3R6J+Tg6Q+oKhkCGzQSa9YgeqxlHIqMcmEdUZwZclhvikRUhM= kevin@gazelle</code></pre> <p><strong>WARNING</strong>: If you see a much longer output that begins with <code>-----BEGIN OPENSSH PRIVATE KEY-----</code>, <em>Do Not</em> share that - it&#39;s your private key. Keep it private&#33;</p> <p>If you need access to multiple servers, repeat the process above to generate a new key for each server you need access to.</p> <h3 id=ol_start3_adding_your_public_key_as_an_authorized_user ><a href="#ol_start3_adding_your_public_key_as_an_authorized_user" class=header-anchor ><ol start=3 > <li><p>Adding your public key as an authorized user</p> </ol> </a></h3> <p>Once you have added the information above to a New User Request issue, Kevin or Shelley will create a user account on the lab server&#40;s&#41;, and add your public keys to the list of authorized keys.</p> <h3 id=ol_start4_set_up_your_ssh_configuration ><a href="#ol_start4_set_up_your_ssh_configuration" class=header-anchor ><ol start=4 > <li><p>Set up your SSH configuration</p> </ol> </a></h3> <p>Now it&#39;s time to set up a configuration file so that when you use <code>ssh</code> commands, your system will know what to do.</p> <p>Create a file in your <code>~/.ssh</code> directory called <code>config</code>, and edit it using a plaintext editor like <code>notepad</code> or visual studio code.</p> <p>Note: Mac users, if you need to save to a hidden folder like <code>~/.ssh</code>, in Finder &#40;or the save window&#41;, you can press <code>cmd &#43; shift &#43; .</code> to reveal them.</p> <p>The basic setup is:</p> <pre><code class="julia hljs">Host &lt;name&gt;
    HostName &lt;url or ip address&gt;
    User &lt;username&gt;
    IdentityFile &lt;path to private key&gt;</code></pre> <ul> <li><p><code>&lt;name&gt;</code>: This can be whatever you like - this is the name you will use to connect</p> <li><p><code>&lt;url or ip address&gt;</code>: address for the system you&#39;re connecting to. Info for lab systems <a href="/drylab/computers">can be found here</a>.</p> <li><p><code>&lt;username&gt;</code>: user name from step 1</p> <li><p><code>&lt;path to private key&gt;</code>: eg <code>~/.ssh/ada-key</code></p> </ul> <p>You can have separate entries for each system that you need to connect to. For example, this is just part of Kevin&#39;s <code>~/.ssh/config</code>:</p> <pre><code class="plaintext hljs">Host ada
    HostName 149.130.201.24
    User kevin
    IdentityFile /home/kevin/.ssh/ada-key
Host hopper
    HostName vkclab-hopper.wellesley.edu
    User kevin
    IdentityFile /home/kevin/.ssh/hopper-key
Host github.com
    User git
    IdentityFile /home/kevin/.ssh/github-key
Host gitlab.com
    User git
    IdentityFile /home/kevin/.ssh/gitlab-key
Host rosalind
    HostName 149.130.162.151
    User kevin
    IdentityFile /home/kevin/.ssh/rosalind-key</code></pre> <p>Once complete, you should be able to do eg <code>ssh ada</code> to connect.</p> <h2 id=troubleshooting ><a href="#troubleshooting" class=header-anchor >Troubleshooting</a></h2> <p>There are a number of problems that can arise when trying to set up SSH access. The following are issues We&#39;ve seen before - if none of them solve your problem, don&#39;t hesitate to contact Kevin to try to resolve it.</p> <h3 id=could_not_resolve_host_name ><a href="#could_not_resolve_host_name" class=header-anchor >Could not resolve host name</a></h3> <p>There are a couple of errors that can occur that report <code>Could not resolve hostname</code>.</p> <h4 id=temporary_failure_in_name_resolution ><a href="#temporary_failure_in_name_resolution" class=header-anchor >Temporary failure in name resolution</a></h4> <p>Usually, you&#39;ll get this error with typos in your command:</p> <pre><code class="plaintext hljs">❯ ssh asa
ssh: Could not resolve hostname asa: Temporary failure in name resolution

❯ ssh ada
Welcome to Pop!_OS 21.04 (GNU/Linux 5.11.0-7620-generic x86_64)</code></pre> <h4 id=name_or_service_not_known ><a href="#name_or_service_not_known" class=header-anchor >Name or service not known</a></h4> <p>This typically means you have a typo in the <code>HostName</code> field of your config file.</p> <p>Occasionally, particularly with <code>ada</code> and <code>hopper</code>, it can arise due to network changes at Wellesley and may require a conversation with LTS. If you&#39;re sure you don&#39;t have typos in your config and this is still happening, let Kevin know.</p> <h3 id=command_hangs_or_connection_timed_out ><a href="#command_hangs_or_connection_timed_out" class=header-anchor >Command hangs or &quot;connection timed out&quot;</a></h3> <p>You must be connected to Wellesley&#39;s network, either through an ethernet cable, by connecting to the <code>Wellesley Secure</code> wifi network, or connecting to the <a href="https://www.wellesley.edu/lts/techsupport/sslvpn">Wellesley VPN</a> in order to connect to a lab server through SSH.</p> <h3 id=too_many_authentication_failures ><a href="#too_many_authentication_failures" class=header-anchor >Too many authentication failures</a></h3> <p>If there is a problem with your SSH setup, sometimes you get an error like:</p> <pre><code class="julia hljs">Received disconnect from <span class=hljs-number >149.130</span><span class=hljs-number >.201</span><span class=hljs-number >.24</span> port <span class=hljs-number >22</span>:<span class=hljs-number >2</span>: Too many auth
entication failures
Disconnected from <span class=hljs-number >149.130</span><span class=hljs-number >.201</span><span class=hljs-number >.24</span> port <span class=hljs-number >22</span></code></pre> <p>Many of these are problems with the remote set up, which you&#39;ll need an admin to solve.</p> <h4 id=permissions_of_authorized_keys_file ><a href="#permissions_of_authorized_keys_file" class=header-anchor >Permissions of authorized_keys file</a></h4> <p>One of the most challenging problems to recognize are problems with permissions. For security, SSH requires that the files that enable access to the system are writable only by the user. This includes the parent <code>~/.ssh</code> directory as well.</p> <h5 id=authorized_keys_owner ><a href="#authorized_keys_owner" class=header-anchor >authorized_keys owner</a></h5> <p>First, check the ownership of the <code>/home/&#36;USER/.ssh/authorized_keys</code> file, where <code>&#36;USER</code> is the user that is having trouble connecting. User <code>ls -l</code> to check</p> <pre><code class="julia hljs">$ ls -l /home/kevin/.ssh/
total <span class=hljs-number >76</span>
-rw-r--r-- <span class=hljs-number >1</span> kevin facstaff <span class=hljs-number >1674</span> Jan <span class=hljs-number >25</span>  <span class=hljs-number >2021</span> aspera.openssh
-rw-rw-r-- <span class=hljs-number >1</span> root  root     <span class=hljs-number >2289</span> Oct <span class=hljs-number >25</span> <span class=hljs-number >09</span>:<span class=hljs-number >41</span> authorized_keys
-rw-r--r-- <span class=hljs-number >1</span> kevin facstaff  <span class=hljs-number >553</span> Oct <span class=hljs-number >28</span>  <span class=hljs-number >2020</span> config
-rw------- <span class=hljs-number >1</span> kevin facstaff <span class=hljs-number >2602</span> Oct <span class=hljs-number >19</span>  <span class=hljs-number >2020</span> documenter-key
-rw-r--r-- <span class=hljs-number >1</span> kevin facstaff  <span class=hljs-number >570</span> Oct <span class=hljs-number >19</span>  <span class=hljs-number >2020</span> documenter-key.pub
<span class=hljs-comment ># ...</span></code></pre> <p>The 3rd and 4th column here are the user and group respectively. Here, each of these files are &quot;owned&quot; by the user <code>kevin</code> and the group <code>facstaff</code>, except for <code>authorized_keys</code>, which is owned by <code>root</code> in the group <code>root</code>.</p> <p>If these are not correct &#40;eg if the owner is &quot;root&quot; or something else&#41;, use <code>chown</code> command &#40;with <code>sudo</code>&#41;, eg</p> <pre><code class="sh hljs">$ sudo <span class=hljs-built_in >chown</span> kevin:facstaff /home/kevin/.ssh/authorized_keys</code></pre>
<p>Replace <code>kevin</code> with the correct user, and <code>facstaff</code> with <code>students</code> if appropriate.</p>
<h5 id=authorized_keys_permissions ><a href="#authorized_keys_permissions" class=header-anchor >authorized_keys permissions</a></h5>
<p>The first column in the output of <code>ls -l</code> is the permissions.</p>
<ul>
<li><p>The first position is <code>-</code> or <code>d</code>, which tells you if it&#39;s a file or not.</p>

<li><p>The next 3 positions are <code>r</code>, <code>w</code>, and <code>x</code>, for <code>r</code>ead, <code>w</code>rite, and e<code>x</code>ecute for the <strong>user</strong>. If the letter is present, that permission is granted, or <code>-</code> if it is not.</p>

<li><p>The next 3 positions are <code>r</code>, <code>w</code>, and <code>x</code> for the <strong>group</strong></p>

<li><p>The next 3 positions are <code>r</code>, <code>w</code>, and <code>x</code> for <strong>other</strong> &#40;everyone else&#41;.</p>

</ul>
<p>For example,</p>
<pre><code class="julia hljs">-rw-r--r--</code></pre>
<p>Is a file &#40;<code>-</code> in the first position&#41;, and the user has read and write permission, while the group and others have read permission.</p>
<p>Another example:</p>
<pre><code class="julia hljs">drwxrwxr-x</code></pre>
<p>is a directory, where the user and group have read/write/execute &#40;for directories, &quot;execute&quot; permissions are necessary to open them&#41;, and other have only read and execute.</p>
<p>The only person that can have write access to <code>authorized_keys</code> is the user. In other words, when you do <code>ls -l</code>, the only <code>w</code> can be in the 3rd position.</p>
<p>In this output:</p>
<pre><code class="julia hljs">$ ls -l /home/kevin/.ssh/
total <span class=hljs-number >76</span>
-rw-r--r-- <span class=hljs-number >1</span> kevin facstaff <span class=hljs-number >1674</span> Jan <span class=hljs-number >25</span>  <span class=hljs-number >2021</span> aspera.openssh
-rw-rw-r-- <span class=hljs-number >1</span> kevin facstaff <span class=hljs-number >2289</span> Oct <span class=hljs-number >25</span> <span class=hljs-number >09</span>:<span class=hljs-number >41</span> authorized_keys
-rw-r--r-- <span class=hljs-number >1</span> kevin facstaff  <span class=hljs-number >553</span> Oct <span class=hljs-number >28</span>  <span class=hljs-number >2020</span> config
-rw------- <span class=hljs-number >1</span> kevin facstaff <span class=hljs-number >2602</span> Oct <span class=hljs-number >19</span>  <span class=hljs-number >2020</span> documenter-key
-rw-r--r-- <span class=hljs-number >1</span> kevin facstaff  <span class=hljs-number >570</span> Oct <span class=hljs-number >19</span>  <span class=hljs-number >2020</span> documenter-key.pub
<span class=hljs-comment ># ...</span></code></pre>
<p>The permissions are <code>-rw-rw-r--</code> for <code>authorized_keys</code> which shows that both user AND group have write access.</p>
<p>To fix this, use <code>chmod</code> &#40;again, you&#39;ll need <code>sudo</code>&#41;:</p>
<pre><code class="sh hljs">$ sudo <span class=hljs-built_in >chmod</span> g=r /home/kevin/.ssh/authorized_keys</code></pre>
<p><strong>Note</strong>: for SSH, even the parent directory needs to have the correct permissions, since someone could just move and re-write the directory as an attack. In other words, the permissions for the <code>/home/&#36;USER/.ssh</code> directory should also be set, usually to <code>drwx------</code>. If not, run</p>
<pre><code class="sh hljs">$ sudo <span class=hljs-built_in >chmod</span> 700 /home/kevin/.ssh</code></pre>
<p>where <code>kevin</code> is replaced by the appropriate user.</p>
<div class=page-foot >
  <div class=copyright >
    &copy; VKC Lab Staff  | Last modified: December 09, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
    </div> 
    </div> 
    </div> <!-- end of class page-wrap-->